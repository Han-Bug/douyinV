// Code generated by hertz generator.

package main

import (
	"douyinV/api/config"
	"douyinV/api/global"
	jwt_demo "douyinV/api/pkg/jwt"
	"douyinV/api/rpc"
	"github.com/cloudwego/hertz/pkg/app/server"
	"github.com/cloudwego/hertz/pkg/common/hlog"
	"time"
)

func Init() {
	var err error
	err = config.InitConfig(&global.APIImpl.ApiConfig, "apiConfig")
	if err != nil {
		hlog.Fatal("config初始化失败")
		panic(err)
	}

	err = rpc.Init()
	if err != nil {
		hlog.Fatal("rpc初始化失败")
		panic(err)
	}

	jwt := jwt_demo.JwtImpl{
		SecretKey: []byte("douyin"),
		ValidTime: time.Hour,
		Issuer:    "HanBug",
		Subject:   "user",
	}
	global.APIImpl.JWTImpl = jwt

}

func main() {

	Init()

	h := server.New(
		server.WithHostPorts(global.APIImpl.ApiConfig.HertzConfig.Address),
	)

	register(h)
	h.Spin()
}
